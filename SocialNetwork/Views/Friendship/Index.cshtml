@model SocialNetwork.Models.ViewModels.FriendshipViewModel

@{
    ViewData["Title"] = "Friends";
}

<div class="main-content">
    <h2>Friends</h2>
    <input type="text" id="searchFriends" placeholder="Search..." class="form-control mb-3" />

    <div class="tabs">
        <button class="btn btn-primary" id="show-friends">Friends</button>
        <button class="btn btn-secondary" id="show-all-users">All Users</button>
        <button class="btn btn-success" id="show-incoming-requests">Incoming Requests</button>
    </div>

    <div id="friends-list" class="friends-container">
        @foreach (var friend in Model.Friends)
        {
            <div class="friend-item">
                <img src="@friend.ProfilePictureUrl" alt="Avatar" class="avatar-small" />
                <p><a href="/Profile/Index/@friend.Id">@friend.FullName</a></p>
                <p>@friend.Description</p>
                <form asp-action="RemoveFriend" method="post">
                    <input type="hidden" name="id" value="@friend.Id" />
                    <button type="submit" class="btn btn-danger">Remove Friend</button>
                </form>
                <a href="/Chat/StartChatWithUser?userId=@friend.Id" class="btn btn-info">Invite to Chat</a>
            </div>
        }
    </div>

    <div id="all-users-list" class="friends-container d-none">
        @foreach (var user in Model.AllUsers)
        {
            <div class="user-item">
                <img src="@user.ProfilePictureUrl" alt="Avatar" class="avatar-small" />
                <p><a href="/Profile/Index/@user.Id">@user.FullName</a></p>
                <p>@user.Description</p>
                <form asp-action="SendRequest" method="post">
                    <input type="hidden" name="id" value="@user.Id" />
                    <button type="submit" class="btn btn-primary">Add Friend</button>
                </form>
                <a href="/Chat/StartChatWithUser?userId=@user.Id" class="btn btn-info">Invite to Chat</a>
            </div>
        }
    </div>

    <div id="incoming-requests-list" class="friends-container d-none">
        @foreach (var request in Model.IncomingRequests)
        {
            <div class="request-item">
                <img src="@request.ProfilePictureUrl" alt="Avatar" class="avatar-small" />
                <p><a href="/Profile/Index/@request.Id">@request.FullName</a></p>
                <p>@request.Description</p>
                <form asp-action="AcceptRequest" method="post">
                    <input type="hidden" name="id" value="@request.Id" />
                    <button type="submit" class="btn btn-success">Accept</button>
                </form>
                <form asp-action="DeclineRequest" method="post" style="margin-left: 10px;">
                    <input type="hidden" name="id" value="@request.Id" />
                    <button type="submit" class="btn btn-danger">Decline</button>
                </form>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('show-friends').addEventListener('click', function () {
            document.getElementById('friends-list').classList.remove('d-none');
            document.getElementById('all-users-list').classList.add('d-none');
            document.getElementById('incoming-requests-list').classList.add('d-none');
        });

        document.getElementById('show-all-users').addEventListener('click', function () {
            document.getElementById('friends-list').classList.add('d-none');
            document.getElementById('all-users-list').classList.remove('d-none');
            document.getElementById('incoming-requests-list').classList.add('d-none');
        });

        document.getElementById('show-incoming-requests').addEventListener('click', function () {
            document.getElementById('friends-list').classList.add('d-none');
            document.getElementById('all-users-list').classList.add('d-none');
            document.getElementById('incoming-requests-list').classList.remove('d-none');
        });
    </script>
}
